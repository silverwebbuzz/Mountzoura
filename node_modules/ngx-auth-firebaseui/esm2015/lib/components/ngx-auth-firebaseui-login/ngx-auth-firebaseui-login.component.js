import { __awaiter, __decorate, __param } from "tslib";
import { Component, EventEmitter, Inject, Input, Output, PLATFORM_ID, ViewEncapsulation } from '@angular/core';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';
import { AuthProcessService, AuthProvider } from '../../services/auth-process.service';
import { NgxAuthFirebaseuiAnimations } from '../../animations';
import { isPlatformBrowser } from '@angular/common';
let NgxAuthFirebaseuiLoginComponent = class NgxAuthFirebaseuiLoginComponent {
    constructor(
    // tslint:disable-next-line:ban-types
    platformId, authProcess, formBuilder) {
        this.platformId = platformId;
        this.authProcess = authProcess;
        this.formBuilder = formBuilder;
        this.providers = AuthProvider.ALL; //  google, facebook, twitter, github as array or all as one single string
        this.registrationEnabled = true;
        this.resetPasswordEnabled = true;
        // i18n
        this.titleText = 'LOGIN TO YOUR ACCOUNT';
        this.rememberMeText = 'Remember Me';
        this.loginButtonText = 'LOGIN';
        this.orLabelText = 'OR';
        this.forgotPasswordText = 'Forgot Password?';
        this.dontHaveAnAccountText = 'Don\'t have an account?';
        this.createAccountButtonText = 'Create an account';
        // i18n email
        this.emailText = 'Email';
        this.emailErrorRequiredText = 'Email is required';
        this.emailErrorPatternText = 'Please enter a valid email address';
        // i18n password
        this.passwordText = 'Password';
        this.passwordErrorRequiredText = 'Password is required';
        // tslint:disable-next-line:no-output-on-prefix
        this.onCreateAccountRequested = new EventEmitter();
        // tslint:disable-next-line:no-output-on-prefix
        this.onResetPasswordRequested = new EventEmitter();
        this.authProviders = AuthProvider;
        this.authenticationError = false;
        this.onSuccess = authProcess.onSuccessEmitter;
        this.onError = authProcess.onErrorEmitter;
    }
    get color() {
        return this.authenticationError ? 'warn' : 'primary';
    }
    get colorAccent() {
        return this.authenticationError ? 'warn' : 'accent';
    }
    ngOnInit() {
        if (isPlatformBrowser(this.platformId)) {
            this.onErrorSubscription = this.onError.subscribe(() => this.authenticationError = true);
        }
        this.updateAuthSnackbarMessages();
        this.loginForm = this.formBuilder.group({
            email: ['', [Validators.required, Validators.email]],
            password: ['', Validators.required]
        });
    }
    updateAuthSnackbarMessages() {
        this.authProcess.messageOnAuthSuccess = this.messageOnAuthSuccess;
        this.authProcess.messageOnAuthError = this.messageOnAuthError;
    }
    login() {
        return __awaiter(this, void 0, void 0, function* () {
            return yield this.authProcess.signInWith(this.authProviders.EmailAndPassword, {
                email: this.loginForm.controls.email.value,
                password: this.loginForm.controls.password.value
            });
        });
    }
};
NgxAuthFirebaseuiLoginComponent.ctorParameters = () => [
    { type: Object, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] },
    { type: AuthProcessService },
    { type: FormBuilder }
];
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "logoUrl", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "providers", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "appearance", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "registrationEnabled", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "resetPasswordEnabled", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "messageOnAuthSuccess", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "messageOnAuthError", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "titleText", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "rememberMeText", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "loginButtonText", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "orLabelText", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "forgotPasswordText", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "dontHaveAnAccountText", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "createAccountButtonText", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "emailText", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "emailErrorRequiredText", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "emailErrorPatternText", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "passwordText", void 0);
__decorate([
    Input()
], NgxAuthFirebaseuiLoginComponent.prototype, "passwordErrorRequiredText", void 0);
__decorate([
    Output()
], NgxAuthFirebaseuiLoginComponent.prototype, "onSuccess", void 0);
__decorate([
    Output()
], NgxAuthFirebaseuiLoginComponent.prototype, "onError", void 0);
__decorate([
    Output()
], NgxAuthFirebaseuiLoginComponent.prototype, "onCreateAccountRequested", void 0);
__decorate([
    Output()
], NgxAuthFirebaseuiLoginComponent.prototype, "onResetPasswordRequested", void 0);
NgxAuthFirebaseuiLoginComponent = __decorate([
    Component({
        selector: 'ngx-auth-firebaseui-login',
        template: "<div fxLayout=\"column\" id=\"login\">\n\n  <div fxLayout=\"column\" fxLayoutAlign=\"center center\" id=\"login-form-wrapper\">\n\n    <div [@animateStagger]=\"{ value: '50' }\" id=\"login-form\">\n\n      <div *ngIf=\"logoUrl\" class=\"logo\">\n        <img [@animate]=\"{ value: '*', params: { x: '50px' } }\" [src]=\"logoUrl\" alt=\"logo\">\n      </div>\n\n      <div [@animate]=\"{ value: '*', params: { x: '-50px' } }\" class=\"title\">{{titleText}}</div>\n\n      <form [@animate]=\"{value:'*',params:{duration:'300ms',y:'100px'}}\" [formGroup]=\"loginForm\" name=\"loginForm\"\n            novalidate>\n\n        <mat-form-field [@animate]=\"{ value: '*', params: { x: '50px' } }\" [appearance]=\"appearance\">\n          <input [placeholder]=\"emailText\" formControlName=\"email\" matInput>\n          <mat-icon [color]=\"color\" matSuffix>email</mat-icon>\n          <mat-error *ngIf=\"loginForm.get('email')?.hasError('required')\">\n            {{emailErrorRequiredText}}\n          </mat-error>\n          <mat-error\n            *ngIf=\"!loginForm.get('email')?.hasError('required') &&\n                                loginForm.get('email')?.hasError('email')\">\n            {{emailErrorPatternText}}\n          </mat-error>\n        </mat-form-field>\n\n        <mat-form-field [@animate]=\"{ value: '*', params: { x: '50px' } }\" [appearance]=\"appearance\">\n          <input [placeholder]=\"passwordText\" formControlName=\"password\" matInput type=\"password\">\n          <mat-icon [color]=\"color\" matSuffix>lock</mat-icon>\n          <mat-error>\n            {{passwordErrorRequiredText}}\n          </mat-error>\n        </mat-form-field>\n\n        <div [@animate]=\"{ value: '*', params: { x: '50px' } }\"\n             class=\"remember-forgot-password\" fxLayout=\"row\"\n             fxLayout.xs=\"column\"\n             fxLayoutAlign=\"space-between center\">\n          <!--          <mat-checkbox class=\"remember-me\" aria-label=\"Remember Me\">-->\n          <!--            {{rememberMeText}}-->\n          <!--          </mat-checkbox>-->\n\n          <button (click)=\"onResetPasswordRequested.emit()\"\n                  *ngIf=\"resetPasswordEnabled\"\n                  [@animate]=\"{ value: '*', params: { x: '-50px' } }\"\n                  [color]=\"color\"\n                  class=\"forgot-password\"\n                  mat-button\n                  type=\"button\">\n            {{forgotPasswordText}}\n          </button>\n        </div>\n\n        <button (click)=\"login()\"\n                [color]=\"colorAccent\"\n                [disabled]=\"loginForm.invalid\"\n                aria-label=\"LOG IN\"\n                class=\"submit-button\"\n                id=\"loginButton\"\n                mat-raised-button>\n          {{loginButtonText}}\n        </button>\n\n      </form>\n\n      <div *ngIf=\"providers.length > 0\"\n           [@animate]=\"{ value: '*', params: { z: '50px', delay: '50ms', scale: '0.2' } }\"\n           class=\"separator\">\n        <span class=\"text\">{{orLabelText}}</span>\n      </div>\n\n      <ngx-auth-firebaseui-providers [providers]=\"providers\"\n                                     fxLayoutAlign=\"center center\"\n                                     layout=\"column\"\n                                     theme=\"raised\"></ngx-auth-firebaseui-providers>\n\n      <div *ngIf=\"registrationEnabled\"\n           [@animateStagger]=\"{ value: '100' }\"\n           class=\"register\"\n           fxLayout=\"column\" fxLayoutAlign=\"center center\">\n        <span [@animate]=\"{ value: '*', params: { x: '100px' } }\" class=\"text\">\n          {{dontHaveAnAccountText}}\n        </span>\n        <button (click)=\"onCreateAccountRequested.emit()\"\n                [@animate]=\"{ value: '*', params: { x: '-100px' } }\"\n                [color]=\"color\"\n                id=\"createAccountButton\"\n                mat-button\n                type=\"button\">{{createAccountButtonText}}</button>\n      </div>\n    </div>\n  </div>\n</div>\n",
        encapsulation: ViewEncapsulation.None,
        animations: NgxAuthFirebaseuiAnimations,
        styles: ["ngx-auth-firebaseui-login #login-form-wrapper{flex:1 0 auto;padding:32px}ngx-auth-firebaseui-login #login-form-wrapper #login-form{width:384px;max-width:384px;padding:32px;text-align:center}ngx-auth-firebaseui-login #login-form-wrapper #login-form .logo{width:150px;height:150px;margin:32px auto}ngx-auth-firebaseui-login #login-form-wrapper #login-form .title{font-size:20px;margin:16px 0 32px}ngx-auth-firebaseui-login #login-form-wrapper #login-form form{width:100%;text-align:left}ngx-auth-firebaseui-login #login-form-wrapper #login-form form mat-form-field{width:100%}ngx-auth-firebaseui-login #login-form-wrapper #login-form form mat-checkbox{margin:0}ngx-auth-firebaseui-login #login-form-wrapper #login-form form .remember-forgot-password{font-size:13px;margin-top:8px}ngx-auth-firebaseui-login #login-form-wrapper #login-form form .remember-forgot-password .remember-me{margin-bottom:16px}ngx-auth-firebaseui-login #login-form-wrapper #login-form form .remember-forgot-password .forgot-password{font-size:13px;font-weight:500;margin-bottom:16px}ngx-auth-firebaseui-login #login-form-wrapper #login-form form .submit-button{width:220px;margin:16px auto;display:block}@media screen and (max-width:599px){ngx-auth-firebaseui-login #login-form-wrapper{padding:16px}ngx-auth-firebaseui-login #login-form-wrapper #login-form{padding:24px;width:100%}ngx-auth-firebaseui-login #login-form-wrapper #login-form form .submit-button{width:90%}ngx-auth-firebaseui-login #login-form-wrapper #login-form button{width:80%}}ngx-auth-firebaseui-login #login-form-wrapper #login-form .register{margin:32px auto 24px;font-weight:500}ngx-auth-firebaseui-login #login-form-wrapper #login-form .register .text{margin-right:8px}ngx-auth-firebaseui-login #login-form-wrapper #login-form .separator{font-size:15px;font-weight:600;margin:24px auto;position:relative;overflow:hidden;width:100px}ngx-auth-firebaseui-login #login-form-wrapper #login-form .separator .text{display:inline-flex;position:relative;padding:0 8px;z-index:9999}ngx-auth-firebaseui-login #login-form-wrapper #login-form .separator .text:after,ngx-auth-firebaseui-login #login-form-wrapper #login-form .separator .text:before{content:\"\";display:block;width:30px;position:absolute;top:10px;border-top:1px solid}ngx-auth-firebaseui-login #login-form-wrapper #login-form .separator .text:before{right:100%}ngx-auth-firebaseui-login #login-form-wrapper #login-form .separator .text:after{left:100%}ngx-auth-firebaseui-login #login-form-wrapper #login-form button.facebook-raised,ngx-auth-firebaseui-login #login-form-wrapper #login-form button.github-raised,ngx-auth-firebaseui-login #login-form-wrapper #login-form button.google-raised,ngx-auth-firebaseui-login #login-form-wrapper #login-form button.microsoft-raised,ngx-auth-firebaseui-login #login-form-wrapper #login-form button.twitter-raised,ngx-auth-firebaseui-login #login-form-wrapper #login-form button.yahoo-raised{width:192px;text-transform:none;color:#fff;font-size:13px;margin-bottom:8px}"]
    }),
    __param(0, Inject(PLATFORM_ID))
], NgxAuthFirebaseuiLoginComponent);
export { NgxAuthFirebaseuiLoginComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWF1dGgtZmlyZWJhc2V1aS1sb2dpbi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZ3gtYXV0aC1maXJlYmFzZXVpLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvbmd4LWF1dGgtZmlyZWJhc2V1aS1sb2dpbi9uZ3gtYXV0aC1maXJlYmFzZXVpLWxvZ2luLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFDLFNBQVMsRUFBRSxZQUFZLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBVSxNQUFNLEVBQUUsV0FBVyxFQUFFLGlCQUFpQixFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ3JILE9BQU8sRUFBQyxXQUFXLEVBQUUsU0FBUyxFQUFFLFVBQVUsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ2xFLE9BQU8sRUFBQyxrQkFBa0IsRUFBRSxZQUFZLEVBQUMsTUFBTSxxQ0FBcUMsQ0FBQztBQUVyRixPQUFPLEVBQUMsMkJBQTJCLEVBQUMsTUFBTSxrQkFBa0IsQ0FBQztBQUM3RCxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQVdsRCxJQUFhLCtCQUErQixHQUE1QyxNQUFhLCtCQUErQjtJQTJDMUM7SUFDRSxxQ0FBcUM7SUFDUixVQUFrQixFQUN4QyxXQUErQixFQUM5QixXQUF3QjtRQUZILGVBQVUsR0FBVixVQUFVLENBQVE7UUFDeEMsZ0JBQVcsR0FBWCxXQUFXLENBQW9CO1FBQzlCLGdCQUFXLEdBQVgsV0FBVyxDQUFhO1FBNUN6QixjQUFTLEdBQXNCLFlBQVksQ0FBQyxHQUFHLENBQUMsQ0FBQywwRUFBMEU7UUFFM0gsd0JBQW1CLEdBQUcsSUFBSSxDQUFDO1FBQzNCLHlCQUFvQixHQUFHLElBQUksQ0FBQztRQUlyQyxPQUFPO1FBQ0UsY0FBUyxHQUFHLHVCQUF1QixDQUFDO1FBQ3BDLG1CQUFjLEdBQUcsYUFBYSxDQUFDO1FBQy9CLG9CQUFlLEdBQUcsT0FBTyxDQUFDO1FB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QUFFOzJFQUE0QjtBQUczQjtJQUFSLEtBQUssRUFBRTtrRUFBcUM7QUFDcEM7SUFBUixLQUFLLEVBQUU7dUVBQWdDO0FBQy9CO0lBQVIsS0FBSyxFQUFFO3dFQUEyQjtBQUMxQjtJQUFSLEtBQUssRUFBRTtvRUFBb0I7QUFDbkI7SUFBUixLQUFLLEVBQUU7MkVBQXlDO0FBQ3hDO0lBQVIsS0FBSyxFQUFFOzhFQUFtRDtBQUNsRDtJQUFSLEtBQUssRUFBRTtnRkFBK0M7QUFHOUM7SUFBUixLQUFLLEVBQUU7a0VBQXFCO0FBQ3BCO0lBQVIsS0FBSyxFQUFFOytFQUE4QztBQUM3QztJQUFSLEtBQUssRUFBRTs4RUFBOEQ7QUFHN0Q7SUFBUixLQUFLLEVBQUU7cUVBQTJCO0FBQzFCO0lBQVIsS0FBSyxFQUFFO2tGQUFvRDtBQUlsRDtJQUFULE1BQU0sRUFBRTtrRUFBZ0I7QUFFZjtJQUFULE1BQU0sRUFBRTtnRUFBYztBQUViO0lBQVQsTUFBTSxFQUFFO2lGQUF5RTtBQUV4RTtJQUFULE1BQU0sRUFBRTtpRkFBeUU7QUFwQ3ZFLCtCQUErQjtJQVAzQyxTQUFTLENBQUM7UUFDVCxRQUFRLEVBQUUsMkJBQTJCO1FBQ3JDLG05SEFBeUQ7UUFFekQsYUFBYSxFQUFFLGlCQUFpQixDQUFDLElBQUk7UUFDckMsVUFBVSxFQUFFLDJCQUEyQjs7S0FDeEMsQ0FBQztJQThDRyxXQUFBLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQTtHQTdDWCwrQkFBK0IsQ0F1RjNDO1NBdkZZLCtCQUErQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIEluamVjdCwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0LCBQTEFURk9STV9JRCwgVmlld0VuY2Fwc3VsYXRpb259IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtGb3JtQnVpbGRlciwgRm9ybUdyb3VwLCBWYWxpZGF0b3JzfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQge0F1dGhQcm9jZXNzU2VydmljZSwgQXV0aFByb3ZpZGVyfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9hdXRoLXByb2Nlc3Muc2VydmljZSc7XG5pbXBvcnQge1N1YnNjcmlwdGlvbn0gZnJvbSAncnhqcyc7XG5pbXBvcnQge05neEF1dGhGaXJlYmFzZXVpQW5pbWF0aW9uc30gZnJvbSAnLi4vLi4vYW5pbWF0aW9ucyc7XG5pbXBvcnQge2lzUGxhdGZvcm1Ccm93c2VyfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHtNYXRGb3JtRmllbGRBcHBlYXJhbmNlfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9mb3JtLWZpZWxkJztcbmltcG9ydCB7VGhlbWVQYWxldHRlfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbC9jb3JlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd4LWF1dGgtZmlyZWJhc2V1aS1sb2dpbicsXG4gIHRlbXBsYXRlVXJsOiAnLi9uZ3gtYXV0aC1maXJlYmFzZXVpLWxvZ2luLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vbmd4LWF1dGgtZmlyZWJhc2V1aS1sb2dpbi5jb21wb25lbnQuc2NzcyddLFxuICBlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lLFxuICBhbmltYXRpb25zOiBOZ3hBdXRoRmlyZWJhc2V1aUFuaW1hdGlvbnNcbn0pXG5leHBvcnQgY2xhc3MgTmd4QXV0aEZpcmViYXNldWlMb2dpbkNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG5cbiAgQElucHV0KCkgbG9nb1VybDogc3RyaW5nO1xuICBASW5wdXQoKSBwcm92aWRlcnM6IHN0cmluZ1tdIHwgc3RyaW5nID0gQXV0aFByb3ZpZGVyLkFMTDsgLy8gIGdvb2dsZSwgZmFjZWJvb2ssIHR3aXR0ZXIsIGdpdGh1YiBhcyBhcnJheSBvciBhbGwgYXMgb25lIHNpbmdsZSBzdHJpbmdcbiAgQElucHV0KCkgYXBwZWFyYW5jZTogTWF0Rm9ybUZpZWxkQXBwZWFyYW5jZTtcbiAgQElucHV0KCkgcmVnaXN0cmF0aW9uRW5hYmxlZCA9IHRydWU7XG4gIEBJbnB1dCgpIHJlc2V0UGFzc3dvcmRFbmFibGVkID0gdHJ1ZTtcbiAgQElucHV0KCkgbWVzc2FnZU9uQXV0aFN1Y2Nlc3M6IHN0cmluZztcbiAgQElucHV0KCkgbWVzc2FnZU9uQXV0aEVycm9yOiBzdHJpbmc7XG5cbiAgLy8gaTE4blxuICBASW5wdXQoKSB0aXRsZVRleHQgPSAnTE9HSU4gVE8gWU9VUiBBQ0NPVU5UJztcbiAgQElucHV0KCkgcmVtZW1iZXJNZVRleHQgPSAnUmVtZW1iZXIgTWUnO1xuICBASW5wdXQoKSBsb2dpbkJ1dHRvblRleHQgPSAnTE9HSU4nO1xuICBASW5wdXQoKSBvckxhYmVsVGV4dCA9ICdPUic7XG4gIEBJbnB1dCgpIGZvcmdvdFBhc3N3b3JkVGV4dCA9ICdGb3Jnb3QgUGFzc3dvcmQ/JztcbiAgQElucHV0KCkgZG9udEhhdmVBbkFjY291bnRUZXh0ID0gJ0RvblxcJ3QgaGF2ZSBhbiBhY2NvdW50Pyc7XG4gIEBJbnB1dCgpIGNyZWF0ZUFjY291bnRCdXR0b25UZXh0ID0gJ0NyZWF0ZSBhbiBhY2NvdW50JztcblxuICAvLyBpMThuIGVtYWlsXG4gIEBJbnB1dCgpIGVtYWlsVGV4dCA9ICdFbWFpbCc7XG4gIEBJbnB1dCgpIGVtYWlsRXJyb3JSZXF1aXJlZFRleHQgPSAnRW1haWwgaXMgcmVxdWlyZWQnO1xuICBASW5wdXQoKSBlbWFpbEVycm9yUGF0dGVyblRleHQgPSAnUGxlYXNlIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzcyc7XG5cbiAgLy8gaTE4biBwYXNzd29yZFxuICBASW5wdXQoKSBwYXNzd29yZFRleHQgPSAnUGFzc3dvcmQnO1xuICBASW5wdXQoKSBwYXNzd29yZEVycm9yUmVxdWlyZWRUZXh0ID0gJ1Bhc3N3b3JkIGlzIHJlcXVpcmVkJztcblxuICAvLyBFdmVudHNcbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLW91dHB1dC1vbi1wcmVmaXhcbiAgQE91dHB1dCgpIG9uU3VjY2VzczogYW55O1xuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tb3V0cHV0LW9uLXByZWZpeFxuICBAT3V0cHV0KCkgb25FcnJvcjogYW55O1xuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tb3V0cHV0LW9uLXByZWZpeFxuICBAT3V0cHV0KCkgb25DcmVhdGVBY2NvdW50UmVxdWVzdGVkOiBFdmVudEVtaXR0ZXI8dm9pZD4gPSBuZXcgRXZlbnRFbWl0dGVyPHZvaWQ+KCk7XG4gIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1vdXRwdXQtb24tcHJlZml4XG4gIEBPdXRwdXQoKSBvblJlc2V0UGFzc3dvcmRSZXF1ZXN0ZWQ6IEV2ZW50RW1pdHRlcjx2b2lkPiA9IG5ldyBFdmVudEVtaXR0ZXI8dm9pZD4oKTtcblxuICBsb2dpbkZvcm06IEZvcm1Hcm91cDtcbiAgYXV0aFByb3ZpZGVycyA9IEF1dGhQcm92aWRlcjtcbiAgb25FcnJvclN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uO1xuICBhdXRoZW50aWNhdGlvbkVycm9yID0gZmFsc2U7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmJhbi10eXBlc1xuICAgIEBJbmplY3QoUExBVEZPUk1fSUQpIHByaXZhdGUgcGxhdGZvcm1JZDogT2JqZWN0LFxuICAgIHB1YmxpYyBhdXRoUHJvY2VzczogQXV0aFByb2Nlc3NTZXJ2aWNlLFxuICAgIHByaXZhdGUgZm9ybUJ1aWxkZXI6IEZvcm1CdWlsZGVyKSB7XG4gICAgdGhpcy5vblN1Y2Nlc3MgPSBhdXRoUHJvY2Vzcy5vblN1Y2Nlc3NFbWl0dGVyO1xuICAgIHRoaXMub25FcnJvciA9IGF1dGhQcm9jZXNzLm9uRXJyb3JFbWl0dGVyO1xuICB9XG5cbiAgZ2V0IGNvbG9yKCk6IHN0cmluZyB8IFRoZW1lUGFsZXR0ZSB7XG4gICAgcmV0dXJuIHRoaXMuYXV0aGVudGljYXRpb25FcnJvciA/ICd3YXJuJyA6ICdwcmltYXJ5JztcbiAgfVxuXG4gIGdldCBjb2xvckFjY2VudCgpOiBzdHJpbmcgfCBUaGVtZVBhbGV0dGUge1xuICAgIHJldHVybiB0aGlzLmF1dGhlbnRpY2F0aW9uRXJyb3IgPyAnd2FybicgOiAnYWNjZW50JztcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuXG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkpIHtcbiAgICAgIHRoaXMub25FcnJvclN1YnNjcmlwdGlvbiA9IHRoaXMub25FcnJvci5zdWJzY3JpYmUoKCkgPT4gdGhpcy5hdXRoZW50aWNhdGlvbkVycm9yID0gdHJ1ZSk7XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVBdXRoU25hY2tiYXJNZXNzYWdlcygpO1xuXG4gICAgdGhpcy5sb2dpbkZvcm0gPSB0aGlzLmZvcm1CdWlsZGVyLmdyb3VwKHtcbiAgICAgIGVtYWlsOiBbJycsIFtWYWxpZGF0b3JzLnJlcXVpcmVkLCBWYWxpZGF0b3JzLmVtYWlsXV0sXG4gICAgICBwYXNzd29yZDogWycnLCBWYWxpZGF0b3JzLnJlcXVpcmVkXVxuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIHVwZGF0ZUF1dGhTbmFja2Jhck1lc3NhZ2VzKCk6IHZvaWQge1xuICAgIHRoaXMuYXV0aFByb2Nlc3MubWVzc2FnZU9uQXV0aFN1Y2Nlc3MgPSB0aGlzLm1lc3NhZ2VPbkF1dGhTdWNjZXNzO1xuICAgIHRoaXMuYXV0aFByb2Nlc3MubWVzc2FnZU9uQXV0aEVycm9yID0gdGhpcy5tZXNzYWdlT25BdXRoRXJyb3I7XG4gIH1cblxuICBhc3luYyBsb2dpbigpIHtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5hdXRoUHJvY2Vzcy5zaWduSW5XaXRoKHRoaXMuYXV0aFByb3ZpZGVycy5FbWFpbEFuZFBhc3N3b3JkLFxuICAgICAge1xuICAgICAgICBlbWFpbDogdGhpcy5sb2dpbkZvcm0uY29udHJvbHMuZW1haWwudmFsdWUsXG4gICAgICAgIHBhc3N3b3JkOiB0aGlzLmxvZ2luRm9ybS5jb250cm9scy5wYXNzd29yZC52YWx1ZVxuICAgICAgfVxuICAgICk7XG4gIH1cbn1cbiJdfQ==